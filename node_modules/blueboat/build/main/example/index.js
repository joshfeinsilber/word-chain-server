"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const cors_1 = __importDefault(require("cors"));
const express_1 = __importDefault(require("express"));
const index_1 = require("../index");
const ChatRoom_1 = __importDefault(require("./ChatRoom"));
const redisOptions = {
    host: 'localhost',
    port: 6379
};
const start = async () => {
    try {
        const app = express_1.default();
        app.use(cors_1.default());
        app.options('*', cors_1.default());
        const server = new index_1.Server({
            app,
            storage: index_1.ClusterMemoryStorage(),
            pubsub: index_1.EventEmitterClusterPubsub.PubSub(),
            adapters: [index_1.EventEmitterClusterPubsub.ClusterAdapter()],
            redis: redisOptions,
            admins: { blueboat: 'pass' }
        });
        server.registerRoom('Chat', ChatRoom_1.default);
        server.listen(4000, () => {
            console.log('Server listening on port 4000');
        });
    }
    catch (e) {
        console.log(e);
    }
};
index_1.EventEmitterClusterPubsub.ProcessStarter(start, 2);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvZXhhbXBsZS9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLGdEQUF1QjtBQUN2QixzREFBNkI7QUFDN0Isb0NBSWlCO0FBQ2pCLDBEQUFpQztBQUVqQyxNQUFNLFlBQVksR0FBRztJQUNuQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsSUFBSTtDQUNYLENBQUE7QUFFRCxNQUFNLEtBQUssR0FBRyxLQUFLLElBQUksRUFBRTtJQUN2QixJQUFJO1FBQ0YsTUFBTSxHQUFHLEdBQUcsaUJBQU8sRUFBRSxDQUFBO1FBQ3JCLEdBQUcsQ0FBQyxHQUFHLENBQUMsY0FBSSxFQUFFLENBQUMsQ0FBQTtRQUNmLEdBQUcsQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLGNBQUksRUFBRSxDQUFDLENBQUE7UUFDeEIsTUFBTSxNQUFNLEdBQUcsSUFBSSxjQUFNLENBQUM7WUFDeEIsR0FBRztZQUNILE9BQU8sRUFBRSw0QkFBb0IsRUFBRTtZQUMvQixNQUFNLEVBQUUsaUNBQXlCLENBQUMsTUFBTSxFQUFFO1lBQzFDLFFBQVEsRUFBRSxDQUFDLGlDQUF5QixDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQ3RELEtBQUssRUFBRSxZQUFZO1lBQ25CLE1BQU0sRUFBRSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUU7U0FDN0IsQ0FBQyxDQUFBO1FBQ0YsTUFBTSxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsa0JBQVEsQ0FBQyxDQUFBO1FBQ3JDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRTtZQUN2QixPQUFPLENBQUMsR0FBRyxDQUFDLCtCQUErQixDQUFDLENBQUE7UUFDOUMsQ0FBQyxDQUFDLENBQUE7S0FDSDtJQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQ1YsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQTtLQUNmO0FBQ0gsQ0FBQyxDQUFBO0FBRUQsaUNBQXlCLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQSJ9