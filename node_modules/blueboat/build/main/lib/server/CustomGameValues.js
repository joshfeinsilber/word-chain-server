"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const RedisKeys_1 = require("../constants/RedisKeys");
/**
 * Used for global game values in which you can change in the admin panel
 */
class CustomGameValues {
    constructor(options) {
        this.storage = null;
        this.setGlobalGameValuesObject = async (newGameValues) => {
            try {
                await this.storage.set(RedisKeys_1.GAME_VALUES, JSON.stringify(newGameValues), {
                    noExpiration: true
                });
            }
            catch (e) {
                throw e;
            }
        };
        this.getGameValues = async () => {
            try {
                const gameValues = await this.storage.get(RedisKeys_1.GAME_VALUES, true);
                if (gameValues) {
                    return JSON.parse(gameValues);
                }
                return {};
            }
            catch (e) {
                return {};
            }
        };
        this.getGameValue = async (key, defaultValue) => {
            try {
                const gameValues = await this.getGameValues();
                if (gameValues[key]) {
                    return gameValues[key];
                }
                return defaultValue;
            }
            catch (e) {
                throw defaultValue;
            }
        };
        this.setGameValue = async (key, value) => {
            try {
                const gameValues = await this.getGameValues();
                const newGameValues = Object.assign({}, gameValues, { [key]: value });
                await this.storage.set(RedisKeys_1.GAME_VALUES, JSON.stringify(newGameValues), true);
            }
            catch (e) {
                throw e;
            }
        };
        this.resetGameValues = async () => {
            try {
                await this.storage.set(RedisKeys_1.GAME_VALUES, JSON.stringify({}), true);
            }
            catch (e) {
                throw e;
            }
        };
        this.storage = options.storage;
    }
}
exports.default = CustomGameValues;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ3VzdG9tR2FtZVZhbHVlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9saWIvc2VydmVyL0N1c3RvbUdhbWVWYWx1ZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxzREFBb0Q7QUFPcEQ7O0dBRUc7QUFDSCxNQUFNLGdCQUFnQjtJQUdwQixZQUFZLE9BQStCO1FBRnBDLFlBQU8sR0FBWSxJQUFJLENBQUE7UUFNdkIsOEJBQXlCLEdBQUcsS0FBSyxFQUFFLGFBQWtCLEVBQUUsRUFBRTtZQUM5RCxJQUFJO2dCQUNGLE1BQU0sSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUJBQVcsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxFQUFFO29CQUNqRSxZQUFZLEVBQUUsSUFBSTtpQkFDbkIsQ0FBQyxDQUFBO2FBQ0g7WUFBQyxPQUFPLENBQUMsRUFBRTtnQkFDVixNQUFNLENBQUMsQ0FBQTthQUNSO1FBQ0gsQ0FBQyxDQUFBO1FBRU0sa0JBQWEsR0FBRyxLQUFLLElBQWtCLEVBQUU7WUFDOUMsSUFBSTtnQkFDRixNQUFNLFVBQVUsR0FBRyxNQUFNLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLHVCQUFXLEVBQUUsSUFBSSxDQUFDLENBQUE7Z0JBQzVELElBQUksVUFBVSxFQUFFO29CQUNkLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQTtpQkFDOUI7Z0JBQ0QsT0FBTyxFQUFFLENBQUE7YUFDVjtZQUFDLE9BQU8sQ0FBQyxFQUFFO2dCQUNWLE9BQU8sRUFBRSxDQUFBO2FBQ1Y7UUFDSCxDQUFDLENBQUE7UUFFTSxpQkFBWSxHQUFHLEtBQUssRUFDekIsR0FBVyxFQUNYLFlBQWdCLEVBQ0osRUFBRTtZQUNkLElBQUk7Z0JBQ0YsTUFBTSxVQUFVLEdBQUcsTUFBTSxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUE7Z0JBQzdDLElBQUksVUFBVSxDQUFDLEdBQUcsQ0FBQyxFQUFFO29CQUNuQixPQUFPLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQTtpQkFDdkI7Z0JBQ0QsT0FBTyxZQUFZLENBQUE7YUFDcEI7WUFBQyxPQUFPLENBQUMsRUFBRTtnQkFDVixNQUFNLFlBQVksQ0FBQTthQUNuQjtRQUNILENBQUMsQ0FBQTtRQUVNLGlCQUFZLEdBQUcsS0FBSyxFQUFFLEdBQVcsRUFBRSxLQUFXLEVBQUUsRUFBRTtZQUN2RCxJQUFJO2dCQUNGLE1BQU0sVUFBVSxHQUFHLE1BQU0sSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFBO2dCQUM3QyxNQUFNLGFBQWEscUJBQVEsVUFBVSxJQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsS0FBSyxHQUFFLENBQUE7Z0JBQ3JELE1BQU0sSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUJBQVcsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFBO2FBQ3pFO1lBQUMsT0FBTyxDQUFDLEVBQUU7Z0JBQ1YsTUFBTSxDQUFDLENBQUE7YUFDUjtRQUNILENBQUMsQ0FBQTtRQUVNLG9CQUFlLEdBQUcsS0FBSyxJQUFJLEVBQUU7WUFDbEMsSUFBSTtnQkFDRixNQUFNLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLHVCQUFXLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQTthQUM5RDtZQUFDLE9BQU8sQ0FBQyxFQUFFO2dCQUNWLE1BQU0sQ0FBQyxDQUFBO2FBQ1I7UUFDSCxDQUFDLENBQUE7UUF4REMsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFBO0lBQ2hDLENBQUM7Q0F3REY7QUFFRCxrQkFBZSxnQkFBZ0IsQ0FBQSJ9