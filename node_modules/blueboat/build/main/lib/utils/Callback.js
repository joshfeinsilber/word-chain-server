"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class Callback {
    constructor() {
        this.callbacks = [];
        this.removeCallback = (id) => {
            this.callbacks = this.callbacks.filter(callback => callback.id !== id);
        };
    }
    add(callback, onlyCallOnce) {
        const id = Math.random().toString();
        this.callbacks.push({
            callback,
            timesCalled: 0,
            canCallMultipleTimes: !onlyCallOnce,
            id
        });
        return { clear: () => this.removeCallback(id) };
    }
    clear() {
        this.callbacks.splice(0, this.callbacks.length);
    }
    call(argument, argument2) {
        this.callbacks = this.callbacks.map(callback => {
            if (callback.timesCalled > 0) {
                if (!callback.canCallMultipleTimes) {
                    return callback;
                }
            }
            callback.callback(argument, argument2);
            return Object.assign({}, callback, { timesCalled: callback.timesCalled + 1 });
        });
    }
}
exports.default = Callback;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2FsbGJhY2suanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbGliL3V0aWxzL0NhbGxiYWNrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBT0EsTUFBTSxRQUFRO0lBQWQ7UUFDUyxjQUFTLEdBQVcsRUFBRSxDQUFBO1FBZ0NyQixtQkFBYyxHQUFHLENBQUMsRUFBVSxFQUFFLEVBQUU7WUFDdEMsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUE7UUFDeEUsQ0FBQyxDQUFBO0lBQ0gsQ0FBQztJQWpDUSxHQUFHLENBQUMsUUFBcUMsRUFBRSxZQUFzQjtRQUN0RSxNQUFNLEVBQUUsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUE7UUFDbkMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUM7WUFDbEIsUUFBUTtZQUNSLFdBQVcsRUFBRSxDQUFDO1lBQ2Qsb0JBQW9CLEVBQUUsQ0FBQyxZQUFZO1lBQ25DLEVBQUU7U0FDSCxDQUFDLENBQUE7UUFDRixPQUFPLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQTtJQUNqRCxDQUFDO0lBRU0sS0FBSztRQUNWLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFBO0lBQ2pELENBQUM7SUFFTSxJQUFJLENBQUMsUUFBYyxFQUFFLFNBQWU7UUFDekMsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUM3QyxJQUFJLFFBQVEsQ0FBQyxXQUFXLEdBQUcsQ0FBQyxFQUFFO2dCQUM1QixJQUFJLENBQUMsUUFBUSxDQUFDLG9CQUFvQixFQUFFO29CQUNsQyxPQUFPLFFBQVEsQ0FBQTtpQkFDaEI7YUFDRjtZQUNELFFBQVEsQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLFNBQVMsQ0FBQyxDQUFBO1lBQ3RDLHlCQUNLLFFBQVEsSUFDWCxXQUFXLEVBQUUsUUFBUSxDQUFDLFdBQVcsR0FBRyxDQUFDLElBQ3RDO1FBQ0gsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDO0NBS0Y7QUFDRCxrQkFBZSxRQUFRLENBQUEifQ==